<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>小超子的博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://rain120.github.io/"/>
  <updated>2018-06-30T12:51:08.418Z</updated>
  <id>https://rain120.github.io/</id>
  
  <author>
    <name>小超子</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vue之网易云音乐横向菜单的实现</title>
    <link href="https://rain120.github.io/2018/06/30/horizontal-menu/"/>
    <id>https://rain120.github.io/2018/06/30/horizontal-menu/</id>
    <published>2018-06-30T12:25:22.000Z</published>
    <updated>2018-06-30T12:51:08.418Z</updated>
    
    <content type="html"><![CDATA[<p>之前在学习的时候有稍微捣鼓一下网易云音乐，主要是为了学习Vue，巩固基础知识，然后看到这个横向菜单，当然个人也喜欢看球，所以每次看腾讯NBA的时候总是会想这个是这样实现的，于是借助之前还没写完的demo，完成这个横向菜单的实现，废话不多说，先上效果图</p><p><img src="https://pic1.zhimg.com/v2-70d17ca415bac63ee97f4c435465052d_b.gif" alt="网易云音乐横向菜单"></p><p>从使用虎牙直播横向菜单的体验得到，我们的横向菜单的业务逻辑如下：</p><ol><li>滑动菜单，并选择菜单项；</li><li>选择某个菜单项，该菜单项居中（去除边界菜单项）</li></ol><p>我们的使用的better-scroll这个插件来实现，具体安装请参考<a href="https://ustbhuangyi.github.io/better-scroll/#/" target="_blank" rel="noopener">BetterScroll</a></p><p>前端DOM结构<br><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mv-tabs"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tabs"</span> <span class="attr">ref</span>=<span class="string">"tabsWrapper"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">ref</span>=<span class="string">"tab"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in tabs"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"selectItem(index)"</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">tag</span>=<span class="string">"div"</span> <span class="attr">:to</span>=<span class="string">"item.to"</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tab-link"</span>&gt;</span></span><span class="template-variable">&#123;&#123;item.title&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>通过使用插件Vue来调试项目<br><img src="https://pic4.zhimg.com/80/v2-1c20983f89395468ddd860b50defb230_hd.jpg" alt="Vue DOM"></p><p>其中tabs包括菜单项名和它的路由<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">data</span> () &#123;</span><br><span class="line">    <span class="selector-tag">return</span> &#123;</span><br><span class="line">      <span class="attribute">tabs</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/recommend-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'推荐'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/music-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'音乐'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'show-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'Show'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/acg-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'二次元'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/dance-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'舞蹈'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/game-mv'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'游戏'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attribute">to</span>: <span class="string">'/mv/mvs'</span>,</span><br><span class="line">          <span class="attribute">title</span>: <span class="string">'mv'</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attribute">mX</span>: <span class="number">0</span>, <span class="comment">// tab移动的距离</span></span><br><span class="line">      <span class="attribute">tabWidth</span>: <span class="number">80</span> <span class="comment">// 每个tab的宽度</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>样式<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">.mv-tabs</span><br><span class="line">    <span class="attribute">position</span> relative</span><br><span class="line">    <span class="attribute">top</span> -<span class="number">5.5rem</span></span><br><span class="line">    <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    .tabs</span><br><span class="line">      <span class="attribute">margin-top</span> <span class="number">3rem</span></span><br><span class="line">      <span class="attribute">height</span> <span class="number">2.5rem</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">      <span class="attribute">line-height</span> <span class="number">2.5rem</span></span><br><span class="line">      <span class="attribute">box-sizing</span> border-box</span><br><span class="line">      <span class="attribute">overflow</span> hidden</span><br><span class="line">      <span class="attribute">white-space</span> nowrap</span><br><span class="line">      .tab-item</span><br><span class="line">        <span class="attribute">float</span> left</span><br><span class="line">        <span class="attribute">width</span> <span class="number">80px</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">40px</span></span><br><span class="line">        <span class="attribute">text-align</span> center</span><br><span class="line">        .tab-link</span><br><span class="line">          <span class="attribute">padding-bottom</span> <span class="number">5px</span></span><br><span class="line">          <span class="attribute">color</span> <span class="number">#333333</span></span><br><span class="line">        &amp;.router-link-active</span><br><span class="line">          <span class="attribute">color</span> <span class="number">#d33a31</span></span><br><span class="line">          <span class="attribute">border-bottom</span> <span class="number">2px</span> solid <span class="number">#d33a31</span></span><br><span class="line">          <span class="attribute">box-sizing</span> border-box</span><br></pre></td></tr></table></figure></p><p>样式和DOM结构就不详细讲了，具体讲实现吧<br>首先需要计算出这个菜单中所有内容的width，也就是包裹这个菜单的容器；接着初始化better-scroll，并忽略该实例对象的垂直方向的滑动.<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    _initMenu () &#123;</span><br><span class="line">      let tabsWidth = <span class="keyword">this</span>.tabWidth</span><br><span class="line">      let width = <span class="keyword">this</span>.tabs.length * tabsWidth</span><br><span class="line">      <span class="keyword">this</span>.$refs.tab.style.width = `$&#123;width&#125;px`</span><br><span class="line">      <span class="keyword">this</span>.$nextTick(() =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">this</span>.scroll) &#123;</span><br><span class="line">          <span class="keyword">this</span>.scroll = new BScroll(<span class="keyword">this</span>.$refs.tabsWrapper, &#123;</span><br><span class="line">            scrollX: <span class="literal">true</span>,</span><br><span class="line">            eventPassthrough: <span class="string">'vertical'</span> <span class="comment">// 忽略这个实例对象的垂直滑动事件</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.scroll.refresh()</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p>这里是第二个业务逻辑的思路（应该会有更好的思路，求大佬指点）</p><p>我的思路是这样的：每一个菜单项都会有各自的点击移动操作，所以我是根据当前tabs的位置，通过点击事件将tabs移动到它相应的位置，例如，中间菜单项在点击时会移动到居中的位置。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">    selectItem (index) &#123;</span><br><span class="line">      let tabs = <span class="keyword">this</span>.$refs.tab</span><br><span class="line">      let moveX = +tabs.style.transform.replace(/[^<span class="number">0</span><span class="number">-9</span>\-,]/g, <span class="string">''</span>).split(<span class="string">','</span>)[<span class="number">0</span>]</span><br><span class="line">      switch (index) &#123;</span><br><span class="line">        case <span class="number">0</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt;= <span class="number">0</span> &amp;&amp; moveX &gt; -<span class="keyword">this</span>.tabWidth) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = <span class="number">0</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">1</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt;= <span class="number">0</span> &amp;&amp; moveX &gt; -<span class="keyword">this</span>.tabWidth * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = <span class="number">0</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">2</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt; <span class="number">0</span> &amp;&amp; moveX &gt;= -<span class="keyword">this</span>.tabWidth * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = <span class="number">0</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">3</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt;= <span class="number">0</span> &amp;&amp; moveX &gt;= -<span class="keyword">this</span>.tabWidth * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = -<span class="keyword">this</span>.tabWidth</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">4</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt;= <span class="number">0</span> &amp;&amp; moveX &gt;= -<span class="keyword">this</span>.tabWidth * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = -<span class="keyword">this</span>.tabWidth * <span class="number">2</span></span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (moveX === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = -<span class="keyword">this</span>.tabWidth * <span class="number">2</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">5</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &lt; <span class="number">0</span> &amp;&amp; moveX &gt; -<span class="keyword">this</span>.tabWidth * <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = -<span class="keyword">this</span>.tabWidth * <span class="number">2</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        case <span class="number">6</span>:</span><br><span class="line">          <span class="keyword">if</span> (moveX &gt; -<span class="keyword">this</span>.tabWidth * <span class="number">2</span> &amp;&amp; moveX &lt; -<span class="keyword">this</span>.tabWidth * <span class="number">3</span> / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.mX = -<span class="keyword">this</span>.tabWidth * <span class="number">2</span> + <span class="number">10</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">      tabs.style.transform = `translate($&#123;<span class="keyword">this</span>.mX&#125;px, <span class="number">0</span>)`</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://pic4.zhimg.com/80/v2-4d0231f220cee3f259b342c80f16da63_hd.jpg" alt="渲染的DOM结构"></p><p>很多时候我们在使用better-scroll的时候，发现这个实例对象已经初始化，但是不能滑动，是因为，Vue是异步更新数据的，所以我们需要异步计算它实际内容的宽度或者高度，Vue提供一个了this.$nextTick()这个hock来实现，这个API是在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。</p><p>官方解释：<a href="https://cn.vuejs.org/v2/api/#Vue-nextTick" target="_blank" rel="noopener">$nextTick</a></p><p>当生命钩子mounted触发时，初始化better-scroll<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._initMenu()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>全部代码<br><figure class="highlight django"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mv-tabs"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tabs"</span> <span class="attr">ref</span>=<span class="string">"tabsWrapper"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">ref</span>=<span class="string">"tab"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in tabs"</span> <span class="attr">:key</span>=<span class="string">"index"</span> @<span class="attr">click</span>=<span class="string">"selectItem(index)"</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">tag</span>=<span class="string">"div"</span> <span class="attr">:to</span>=<span class="string">"item.to"</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tab-link"</span>&gt;</span></span><span class="template-variable">&#123;&#123;item.title&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml">import BScroll from 'better-scroll'</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">export default &#123;</span></span><br><span class="line"><span class="xml">  data () &#123;</span></span><br><span class="line"><span class="xml">    return &#123;</span></span><br><span class="line"><span class="xml">      tabs: [</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/recommend-mv',</span></span><br><span class="line"><span class="xml">          title: '推荐'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/music-mv',</span></span><br><span class="line"><span class="xml">          title: '音乐'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: 'show-mv',</span></span><br><span class="line"><span class="xml">          title: 'Show'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/acg-mv',</span></span><br><span class="line"><span class="xml">          title: '二次元'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/dance-mv',</span></span><br><span class="line"><span class="xml">          title: '舞蹈'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/game-mv',</span></span><br><span class="line"><span class="xml">          title: '游戏'</span></span><br><span class="line"><span class="xml">        &#125;,</span></span><br><span class="line"><span class="xml">        &#123;</span></span><br><span class="line"><span class="xml">          to: '/mv/mvs',</span></span><br><span class="line"><span class="xml">          title: 'mv'</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">      ],</span></span><br><span class="line"><span class="xml">      mX: 0,</span></span><br><span class="line"><span class="xml">      tabWidth: 80</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;,</span></span><br><span class="line"><span class="xml">  mounted () &#123;</span></span><br><span class="line"><span class="xml">    this.$nextTick(() =&gt; &#123;</span></span><br><span class="line"><span class="xml">      this._initMenu()</span></span><br><span class="line"><span class="xml">    &#125;)</span></span><br><span class="line"><span class="xml">  &#125;,</span></span><br><span class="line"><span class="xml">  methods: &#123;</span></span><br><span class="line"><span class="xml">    selectItem (index) &#123;</span></span><br><span class="line"><span class="xml">      let tabs = this.$refs.tab</span></span><br><span class="line"><span class="xml">      let moveX = +tabs.style.transform.replace(/[^0-9\-,]/g, '').split(',')[0]</span></span><br><span class="line"><span class="xml">      switch (index) &#123;</span></span><br><span class="line"><span class="xml">        case 0:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt;<span class="name">=</span> <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span> -this.tabWidth) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = 0</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 1:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt;<span class="name">=</span> <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span> -this.tabWidth * 2) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = 0</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 2:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt; <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span>= -this.tabWidth * 2) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = 0</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 3:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt;<span class="name">=</span> <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span>= -this.tabWidth * 2) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = -this.tabWidth</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 4:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt;<span class="name">=</span> <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span>= -this.tabWidth * 2) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = -this.tabWidth * 2</span></span><br><span class="line"><span class="xml">          &#125; else if (moveX === 0) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = -this.tabWidth * 2</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 5:</span></span><br><span class="line"><span class="xml">          if (moveX <span class="tag">&lt; <span class="attr">0</span> &amp;&amp; <span class="attr">moveX</span> &gt;</span> -this.tabWidth * 2) &#123;</span></span><br><span class="line"><span class="xml">            this.mX = -this.tabWidth * 2</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        case 6:</span></span><br><span class="line"><span class="xml">          if (moveX &gt; -this.tabWidth * 2 &amp;&amp; moveX <span class="tag">&lt; <span class="attr">-this.tabWidth</span> * <span class="attr">3</span> / <span class="attr">2</span>) &#123;</span></span></span><br><span class="line"><span class="xml">            this.mX = -this.tabWidth * 2 + 10</span></span><br><span class="line"><span class="xml">          &#125;</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">        default:</span></span><br><span class="line"><span class="xml">          break</span></span><br><span class="line"><span class="xml">      &#125;</span></span><br><span class="line"><span class="xml">      tabs.style.transform = `translate($&#123;this.mX&#125;px, 0)`</span></span><br><span class="line"><span class="xml">    &#125;,</span></span><br><span class="line"><span class="xml">    _initMenu () &#123;</span></span><br><span class="line"><span class="xml">      let tabsWidth = this.tabWidth</span></span><br><span class="line"><span class="xml">      let width = this.tabs.length * tabsWidth</span></span><br><span class="line"><span class="xml">      this.$refs.tab.style.width = `$&#123;width&#125;px`</span></span><br><span class="line"><span class="xml">      this.$nextTick(() =&gt; &#123;</span></span><br><span class="line"><span class="xml">        if (!this.scroll) &#123;</span></span><br><span class="line"><span class="xml">          this.scroll = new BScroll(this.$refs.tabsWrapper, &#123;</span></span><br><span class="line"><span class="xml">            scrollX: true,</span></span><br><span class="line"><span class="xml">            eventPassthrough: 'vertical'</span></span><br><span class="line"><span class="xml">          &#125;)</span></span><br><span class="line"><span class="xml">        &#125; else &#123;</span></span><br><span class="line"><span class="xml">          this.scroll.refresh()</span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">      &#125;)</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"stylus"</span> <span class="attr">scoped</span>&gt;</span><span class="undefined"></span></span></span><br><span class="line"><span class="xml">  .mv-tabs</span></span><br><span class="line"><span class="xml">    position relative</span></span><br><span class="line"><span class="xml">    top -5.5rem</span></span><br><span class="line"><span class="xml">    bottom 0</span></span><br><span class="line"><span class="xml">    width 100%</span></span><br><span class="line"><span class="xml">    .tabs</span></span><br><span class="line"><span class="xml">      margin-top 3rem</span></span><br><span class="line"><span class="xml">      height 2.5rem</span></span><br><span class="line"><span class="xml">      width 100%</span></span><br><span class="line"><span class="xml">      line-height 2.5rem</span></span><br><span class="line"><span class="xml">      box-sizing border-box</span></span><br><span class="line"><span class="xml">      overflow hidden</span></span><br><span class="line"><span class="xml">      white-space nowrap</span></span><br><span class="line"><span class="xml">      .tab-item</span></span><br><span class="line"><span class="xml">        float left</span></span><br><span class="line"><span class="xml">        width 80px</span></span><br><span class="line"><span class="xml">        height 40px</span></span><br><span class="line"><span class="xml">        text-align center</span></span><br><span class="line"><span class="xml">        .tab-link</span></span><br><span class="line"><span class="xml">          padding-bottom 5px</span></span><br><span class="line"><span class="xml">          color #333333</span></span><br><span class="line"><span class="xml">        &amp;.router-link-active</span></span><br><span class="line"><span class="xml">          color #d33a31</span></span><br><span class="line"><span class="xml">          border-bottom 2px solid #d33a31</span></span><br><span class="line"><span class="xml">          box-sizing border-box</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;之前在学习的时候有稍微捣鼓一下网易云音乐，主要是为了学习Vue，巩固基础知识，然后看到这个横向菜单，当然个人也喜欢看球，所以每次看腾讯NBA的时候总是会想这个是这样实现的，于是借助之前还没写完的demo，完成这个横向菜单的实现，废话不多说，先上效果图&lt;/p&gt;
&lt;p&gt;&lt;img
      
    
    </summary>
    
      <category term="Vue" scheme="https://rain120.github.io/categories/Vue/"/>
    
    
      <category term="Vue" scheme="https://rain120.github.io/tags/Vue/"/>
    
      <category term="better-scroll" scheme="https://rain120.github.io/tags/better-scroll/"/>
    
      <category term="横向菜单" scheme="https://rain120.github.io/tags/%E6%A8%AA%E5%90%91%E8%8F%9C%E5%8D%95/"/>
    
  </entry>
  
  <entry>
    <title>Vue之网易云音乐PC版轮播图的实现</title>
    <link href="https://rain120.github.io/2018/06/25/netease-slider/"/>
    <id>https://rain120.github.io/2018/06/25/netease-slider/</id>
    <published>2018-06-25T10:30:29.000Z</published>
    <updated>2018-06-30T12:23:07.242Z</updated>
    
    <content type="html"><![CDATA[<p>最近在刷网易云音乐歌单时发现首页的轮播图很有意思，正好自己想尝试做一个PC版的网易云音乐，于是就是使用Vue去做这个demo，废话少说，我要出招了，接招吧</p><p><img src="https://pic4.zhimg.com/v2-aa1345f02914a282d6b09d32ecd3e3e1_b.gif" alt="网易云音乐PC版轮播图"></p><h4 id="页面的DOM结构"><a href="#页面的DOM结构" class="headerlink" title="页面的DOM结构"></a>页面的DOM结构</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"slider-container"</span> ref=<span class="symbol">'slide</span>r'</span><br><span class="line">       :style=<span class="string">"sliderStyle"</span></span><br><span class="line">       <span class="meta">@mouseover</span>=<span class="string">"pause()"</span></span><br><span class="line">       <span class="meta">@mouseout</span>=<span class="string">"play()"</span>&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"slider-content"</span> :<span class="class"><span class="keyword">class</span></span>=<span class="string">"mask ? 'mask' : ''"</span>&gt;</span><br><span class="line">      &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"slider"</span> v-<span class="keyword">for</span>=<span class="string">"(item, index) in list"</span></span><br><span class="line">        :key=<span class="string">"index"</span></span><br><span class="line">        :<span class="class"><span class="keyword">class</span></span>=<span class="string">"setClass(index)"</span></span><br><span class="line">        <span class="meta">@click</span>=<span class="string">"onClick(index)"</span> :style=<span class="string">"setBGImg(item.src)"</span>&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;i v-show=<span class="string">"arrow"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"iconfont icon-left"</span> <span class="meta">@click</span>=<span class="string">"prev()"</span>&gt;&lt;/i&gt;</span><br><span class="line">      &lt;i v-show=<span class="string">"arrow"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"iconfont icon-right"</span> <span class="meta">@click</span>=<span class="string">"next()"</span>&gt;&lt;/i&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"dots"</span> v-<span class="keyword">if</span>=<span class="string">"dots"</span>&gt;</span><br><span class="line">      &lt;span v-<span class="keyword">for</span>=<span class="string">"(item, index) in list"</span> :key=<span class="string">"index"</span></span><br><span class="line">        :style=<span class="string">"setActiveDot(index)"</span></span><br><span class="line">        <span class="meta">@mouseover</span>=<span class="string">"currentIndex = index"</span>&gt;&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="Slider-container的样式-Stylus"><a href="#Slider-container的样式-Stylus" class="headerlink" title="Slider-container的样式(Stylus)"></a>Slider-container的样式(Stylus)</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.slider-container</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br></pre></td></tr></table></figure><p>这个子组件主要分为两块。</p><ol><li>轮播图，其中它们的业务逻辑是</li></ol><ul><li>自动切换</li><li>左右icon切换轮播图</li><li>点击前后轮播图切换轮播图</li><li>鼠标滑动到轮播图停止轮播，离开后继续轮播</li></ul><h4 id="Slider-content的DOM结构"><a href="#Slider-content的DOM结构" class="headerlink" title="Slider-content的DOM结构"></a>Slider-content的DOM结构</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"slider-content"</span> :<span class="class"><span class="keyword">class</span></span>=<span class="string">"mask ? 'mask' : ''"</span>&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"slider"</span> v-<span class="keyword">for</span>=<span class="string">"(item, index) in list"</span></span><br><span class="line">    :key=<span class="string">"index"</span></span><br><span class="line">    :<span class="class"><span class="keyword">class</span></span>=<span class="string">"setClass(index)"</span></span><br><span class="line">    <span class="meta">@click</span>=<span class="string">"onClick(index)"</span> :style=<span class="string">"setBGImg(item.src)"</span>&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;i v-show=<span class="string">"arrow"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"iconfont icon-left"</span> <span class="meta">@click</span>=<span class="string">"prev()"</span>&gt;&lt;/i&gt;</span><br><span class="line">  &lt;i v-show=<span class="string">"arrow"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"iconfont icon-right"</span> <span class="meta">@click</span>=<span class="string">"next()"</span>&gt;&lt;/i&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><h4 id="Slider-content的样式-Stylus"><a href="#Slider-content的样式-Stylus" class="headerlink" title="Slider-content的样式(Stylus)"></a>Slider-content的样式(Stylus)</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">.slider-<span class="attribute">content</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span>: calc(<span class="number">100%</span> - <span class="number">20px</span>)</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0%</span></span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0%</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span></span><br><span class="line">    <span class="attribute">background-size</span>: inherit</span><br><span class="line">    <span class="selector-class">.slider</span> </span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">top</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">left</span>: <span class="number">50%</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">65%</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">      <span class="attribute">transition</span>: <span class="number">500ms</span> all ease-in-out</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#fff</span></span><br><span class="line">      <span class="attribute">background-repeat</span>: no-repeat</span><br><span class="line">      <span class="attribute">background-position</span>: center</span><br><span class="line">      <span class="attribute">background-size</span>: inherit</span><br><span class="line">      <span class="attribute">transform</span>: translate3d(-<span class="number">50%</span>,<span class="number">0</span>,-<span class="number">80px</span>)</span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">1</span></span><br><span class="line">      &amp;:before</span><br><span class="line">        <span class="attribute">position</span>: absolute</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">""</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">background-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="attribute">transition-delay</span>: <span class="number">100ms</span>!important</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">500ms</span></span><br><span class="line">        <span class="attribute">cursor</span>: pointer</span><br><span class="line">      &amp;.active</span><br><span class="line">        <span class="attribute">transform</span>: translate3d(-<span class="number">50%</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">20</span></span><br><span class="line">      &amp;.prev</span><br><span class="line">        <span class="attribute">transform</span>: translate3d(-<span class="number">75%</span>, <span class="number">0</span>, -<span class="number">100px</span>)</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">19</span></span><br><span class="line">      &amp;.next</span><br><span class="line">        <span class="attribute">transform</span>: translate3d(-<span class="number">25%</span>, <span class="number">0</span>, -<span class="number">100px</span>)</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">18</span></span><br><span class="line">    i</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">17.5%</span></span><br><span class="line">      <span class="attribute">display</span>: none</span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">40%</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">22px</span></span><br><span class="line">      <span class="attribute">color</span>: rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>)</span><br><span class="line">      <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">24px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>)</span><br><span class="line">      <span class="attribute">cursor</span>: pointer</span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">21</span></span><br><span class="line">      &amp;:first-child</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">      &amp;:last-child</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">    &amp;:hover</span><br><span class="line">      i</span><br><span class="line">        <span class="attribute">color</span>: rgba(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>)</span><br><span class="line">        <span class="attribute">display</span>: block</span><br><span class="line">    &amp;.<span class="attribute">mask</span></span><br><span class="line">      <span class="selector-class">.slider</span> </span><br><span class="line">        &amp;<span class="selector-class">.prev</span>, &amp;.next</span><br><span class="line">          &amp;:before</span><br><span class="line">            <span class="attribute">background-color</span>: rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.50</span>)</span><br></pre></td></tr></table></figure><ol><li>底部的dot， 其中它们的业务逻辑是</li></ol><ul><li>当前轮播图对应位置的dot高亮</li><li>鼠标移动到相应的dot上切换对应位置的轮播图</li></ul><h4 id="Dots的DOM结构"><a href="#Dots的DOM结构" class="headerlink" title="Dots的DOM结构"></a>Dots的DOM结构</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"dots"</span> v-<span class="keyword">if</span>=<span class="string">"dots"</span>&gt;</span><br><span class="line">  &lt;span v-<span class="keyword">for</span>=<span class="string">"(item, index) in list"</span> :key=<span class="string">"index"</span></span><br><span class="line">    :style=<span class="string">"setActiveDot(index)"</span></span><br><span class="line">    @mouseover=<span class="string">"currentIndex = index"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Dots的样式-Stylus"><a href="#Dots的样式-Stylus" class="headerlink" title="Dots的样式(Stylus)"></a>Dots的样式(Stylus)</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dots</span> </span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span></span><br><span class="line">  span</span><br><span class="line">    <span class="attribute">display</span>: inline-block</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">1px</span> <span class="number">3px</span></span><br><span class="line">    <span class="attribute">cursor</span>: pointer</span><br></pre></td></tr></table></figure><p>上面是页面的DOM结构和表现的实现代码，接下来我们要讲的是连招的实现，小心啦，我要摸眼W + R3了。<br>上面我们讲到轮播图的业务逻辑，接下来，我们就讲讲如何实现的的吧</p><h4 id="自动轮播"><a href="#自动轮播" class="headerlink" title="自动轮播"></a>自动轮播</h4><p><img src="https://pic2.zhimg.com/v2-4c50c0ab424efb6f4407750a5363a064_b.gif" alt="自动轮播"><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">play () &#123;</span><br><span class="line">  <span class="keyword">this</span>.pause();</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.autoPlay) &#123;</span><br><span class="line">    <span class="keyword">this</span>.timer = setInterval(()=&gt;&#123;</span><br><span class="line">      <span class="keyword">this</span>.next();</span><br><span class="line">    &#125;, <span class="keyword">this</span>.interval)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="暂停轮播"><a href="#暂停轮播" class="headerlink" title="暂停轮播"></a>暂停轮播</h4><p><img src="https://pic4.zhimg.com/v2-676abb1ff4789e2d85d4131b1994a6f1_b.gif" alt="暂停轮播"><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pause () &#123;</span><br><span class="line">  clearInterval(<span class="keyword">this</span>.timer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="Icon切换轮播图"><a href="#Icon切换轮播图" class="headerlink" title="Icon切换轮播图"></a>Icon切换轮播图</h4><p><img src="https://pic4.zhimg.com/v2-c6d66c91bec8b981a43fd9d732ef3f6e_b.gif" alt="Icon切换轮播图"><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">next () &#123;</span><br><span class="line">  <span class="keyword">this</span>.currentIndex = ++<span class="keyword">this</span>.currentIndex % <span class="keyword">this</span>.list.length;</span><br><span class="line">&#125;,</span><br><span class="line">prev () &#123;</span><br><span class="line">  <span class="keyword">this</span>.currentIndex = <span class="keyword">this</span>.currentIndex === <span class="number">0</span> ? <span class="keyword">this</span>.list.length - <span class="number">1</span> : <span class="keyword">this</span>.currentIndex - <span class="number">1</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p><h4 id="前后轮播图的切换轮播图"><a href="#前后轮播图的切换轮播图" class="headerlink" title="前后轮播图的切换轮播图"></a>前后轮播图的切换轮播图</h4><p><img src="https://pic4.zhimg.com/v2-05c1fccb6e249e80ac3824201caba195_b.gif" alt="前后轮播图的切换轮播图"><br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">onClick (i) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i === <span class="keyword">this</span>.currentIndex)&#123;</span><br><span class="line">    <span class="keyword">this</span>.$emit(<span class="string">'sliderClick'</span>, i);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    let currentClickClassName = <span class="keyword">this</span>.sliderDomList[i].className.split(<span class="string">' '</span>)[<span class="number">1</span>]</span><br><span class="line">    console.log(currentClickClassName)</span><br><span class="line">    <span class="keyword">if</span> (currentClickClassName === <span class="string">'next'</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>.next()</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.prev()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="dots轮播图的切换轮播图"><a href="#dots轮播图的切换轮播图" class="headerlink" title="dots轮播图的切换轮播图"></a>dots轮播图的切换轮播图</h4><p><img src="https://pic3.zhimg.com/v2-2ed08e804e05ab49f0f54fbd1cc37b5e_b.gif" alt="dots轮播图的切换轮播图"><br>这里比较简单，只需要设置它的鼠标事件即可<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@mouseover</span>=<span class="string">"currentIndex = index"</span></span><br></pre></td></tr></table></figure></p><p>到这里，基本上我们提出的业务逻辑原理都已经实现了，到时候我会将代码整理完了commit到github上，现在正在整理ing，谢谢。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;最近在刷网易云音乐歌单时发现首页的轮播图很有意思，正好自己想尝试做一个PC版的网易云音乐，于是就是使用Vue去做这个demo，废话少说，我要出招了，接招吧&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://pic4.zhimg.com/v2-aa1345f02914a282
      
    
    </summary>
    
      <category term="Vue" scheme="https://rain120.github.io/categories/Vue/"/>
    
    
      <category term="Vue" scheme="https://rain120.github.io/tags/Vue/"/>
    
      <category term="网易云音乐" scheme="https://rain120.github.io/tags/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90/"/>
    
      <category term="轮播图" scheme="https://rain120.github.io/tags/%E8%BD%AE%E6%92%AD%E5%9B%BE/"/>
    
  </entry>
  
</feed>
